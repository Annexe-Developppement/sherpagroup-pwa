{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{1035:function(e,n,a){\"use strict\";a.r(n);var t=a(10),i=a.n(t),r=a(6),d=a.n(r),l=a(0),o=a.n(l),c=a(62),u=a(842),s=a.n(u),m=a(420),k=a(843),v=a.n(k),p=a(714),f=a(659),b=a(177),y=a(844).parse;n.default=function(){var e=Object(f.b)(d()({},p.a)),n=e.handlePlaceOrder,a=e.orderNumber,t=e.orderDetailsData,r=window.location.search,u=y(r.replace(/^\\?/,\"\")),k=u.token,h=u.PayerID,N=Object(l.useState)(!1),g=i()(N,2),_=g[0],S=g[1],O=Object(l.useState)(!1),j=i()(O,2),w=j[0],C=j[1],E=Object(l.useState)(!0),D=i()(E,2),V=D[0],F=D[1],x=Object(f.c)({mutation:s.a}),P=x.handleSetPaymentMethod,T=x.paymentMethodResponse,$=Object(b.g)({mutation:v.a}).handleSetGuestEmail;return!_&&k&&h&&(P({payment_method:\"paypal_express\",payer_id:h,token:k}),S(!0)),!w&&localStorage.getItem(\"customerEmail\")&&($({email:localStorage.getItem(\"customerEmail\")}),C(!0)),\"paypal_express\"==T&&V&&(n(),F(!1)),a&&t?o.a.createElement(c.a,{to:{pathname:\"/checkout\",state:{orderDetailsData:t,orderNumber:a}}}):o.a.createElement(\"div\",null,o.a.createElement(m.a,null,\"Please wait...\"))}},461:function(e,n,a){\"use strict\";a.d(n,\"a\",(function(){return l}));var t,i=a(80),r=a.n(i),d=a(17),l=Object(d.gql)(t||(t=r()([\"\\n    fragment CheckoutPageFragment on Cart {\\n        id\\n        items {\\n            id\\n            product {\\n                id\\n                stock_status\\n            }\\n        }\\n        # If total quantity is falsy we render empty.\\n        total_quantity\\n    }\\n\"])))},597:function(e,n,a){\"use strict\";a.d(n,\"a\",(function(){return l}));var t,i=a(80),r=a.n(i),d=a(17),l=Object(d.gql)(t||(t=r()([\"\\n    fragment ItemsReviewFragment on Cart {\\n        id\\n        total_quantity\\n        items {\\n            id\\n            product {\\n                id\\n                name\\n                thumbnail {\\n                    url\\n                }\\n            }\\n            quantity\\n            ... on SimpleCartItem {\\n                customizable_options {\\n                    label\\n                    values {\\n                        label\\n                        value\\n                    }\\n                }\\n            }\\n            ... on ConfigurableCartItem {\\n                configurable_options {\\n                    id\\n                    option_label\\n                    value_id\\n                    value_label\\n                }\\n            }\\n            ... on BundleCartItem {\\n                bundle_options {\\n                    uid\\n                    label\\n                    type\\n                    values {\\n                        id\\n                        label\\n                        price\\n                        quantity\\n                    }\\n                }\\n            }\\n        }\\n    }\\n\"])))},659:function(e,n,a){\"use strict\";a.d(n,\"a\",(function(){return f})),a.d(n,\"c\",(function(){return b})),a.d(n,\"b\",(function(){return y}));var t=a(4),i=a.n(t),r=a(9),d=a.n(r),l=a(10),o=a.n(l),c=a(0),u=a(17),s=a(113),m=a(170),k=a(660),v=a.n(k),p=3,f=function(){var e=window.location.origin,n=Object(m.b)(),a=o()(n,1)[0].cartId,t=Object(u.useMutation)(v.a),r=o()(t,2),l=r[0],s=r[1].data;return{handleCreateToken:Object(c.useCallback)(d()(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l({variables:{cart_id:a,return_url:e+\"/paypal-review\",cancel_url:e+\"/checkout\"}});case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),console.log(n.t0);case 8:case\"end\":return n.stop()}}),n,null,[[0,5]])}))),[a,l,e]),tokenResponse:s&&s.createPaypalExpressToken}},b=function(e){var n=e.mutation,a=Object(m.b)(),t=o()(a,1)[0].cartId,r=Object(u.useMutation)(n),l=o()(r,2),s=l[0],k=l[1].data,v=Object(c.useState)(!1),p=o()(v,2),f=p[0],b=p[1];return{handleSetPaymentMethod:Object(c.useCallback)(function(){var e=d()(i.a.mark((function e(n){var a,r,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.payment_method,r=n.payer_id,d=n.token,b(!0),e.next=4,s({variables:{cart_id:t,payment_method:a,payer_id:r,token:d}});case 4:b(!1);case 5:case\"end\":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t,s]),inProgress:f,paymentMethodResponse:k&&k.setPaymentMethodOnCart&&k.setPaymentMethodOnCart.cart&&k.setPaymentMethodOnCart.cart.selected_payment_method&&k.setPaymentMethodOnCart.cart.selected_payment_method.code}},y=function(e){var n=e.mutations,a=n.createCartMutation,t=n.placeOrderMutation,r=e.queries.getOrderDetailsQuery,l=Object(m.b)(),k=o()(l,2),v=k[0].cartId,f=k[1],b=f.createCart,y=f.removeCart,h=Object(u.useApolloClient)(),N=Object(u.useMutation)(a),g=o()(N,1)[0],_=Object(u.useMutation)(t),S=o()(_,2),O=S[0],j=S[1],w=j.data,C=j.called,E=Object(u.useQuery)(r,{variables:{cartId:v},fetchPolicy:\"no-cache\"}),D=E.data,V=E.loading;return Object(c.useEffect)((function(){function e(){return(e=d()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({variables:{cartId:v}});case 3:return e.next=5,y();case 5:return e.next=7,Object(s.a)(h);case 7:return e.next=9,b({fetchCartId:g});case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(\"An error occurred during when placing the order\",e.t0),setReviewOrderButtonClicked(!1),setCheckoutStep(p);case 16:case\"end\":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}D&&!C&&function(){e.apply(this,arguments)}()}),[h,v,b,g,D,O,C,y]),{handlePlaceOrder:function(){},orderDetailsData:D,orderDetailsLoading:V,orderNumber:w&&w.placeOrder.order.order_number||null}}},660:function(e,n){var a={kind:\"Document\",definitions:[{kind:\"OperationDefinition\",operation:\"mutation\",name:{kind:\"Name\",value:\"createPaypalExpressToken\"},variableDefinitions:[{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"return_url\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"cancel_url\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"createPaypalExpressToken\"},arguments:[{kind:\"Argument\",name:{kind:\"Name\",value:\"input\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"cart_id\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"code\"},value:{kind:\"StringValue\",value:\"paypal_express\",block:!1}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"express_button\"},value:{kind:\"BooleanValue\",value:!0}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"urls\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"return_url\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"return_url\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"cancel_url\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"cancel_url\"}}}]}}]}}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"token\"},arguments:[],directives:[]},{kind:\"Field\",name:{kind:\"Name\",value:\"paypal_urls\"},arguments:[],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"start\"},arguments:[],directives:[]},{kind:\"Field\",name:{kind:\"Name\",value:\"edit\"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:434}};a.loc.source={body:'mutation createPaypalExpressToken(\\n    $cart_id: String!\\n    $return_url: String!\\n    $cancel_url: String!\\n) {\\n    createPaypalExpressToken(\\n        input: {\\n            cart_id: $cart_id\\n            code: \"paypal_express\"\\n            express_button: true\\n            urls: { return_url: $return_url, cancel_url: $cancel_url }\\n        }\\n    ) {\\n        token\\n        paypal_urls {\\n            start\\n            edit\\n        }\\n    }\\n}\\n',name:\"GraphQL request\",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var a=0;a<e.definitions.length;a++){var t=e.definitions[a];if(t.name&&t.name.value==n)return t}}a.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,a){if(\"FragmentSpread\"===n.kind)a.add(n.name.value);else if(\"VariableDefinition\"===n.kind){var t=n.type;\"NamedType\"===t.kind&&a.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,a)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,a)})),n.definitions&&n.definitions.forEach((function(n){e(n,a)}))}(e,n),t[e.name.value]=n}})),e.exports=a,e.exports.createPaypalExpressToken=function(e,n){var a={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty(\"loc\")&&(a.loc=e.loc);var r=t[n]||new Set,d=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){d.has(e)||(d.add(e),(t[e]||new Set).forEach((function(e){l.add(e)})))}))}return d.forEach((function(n){var t=i(e,n);t&&a.definitions.push(t)})),a}(a,\"createPaypalExpressToken\")},714:function(e,n,a){\"use strict\";var t,i,r,d,l,o,c=a(80),u=a.n(c),s=a(17),m=a(461),k=a(597),v=Object(s.gql)(t||(t=u()([\"\\n    fragment OrderConfirmationPageFragment on Cart {\\n        id\\n        email\\n        total_quantity\\n        shipping_addresses {\\n            firstname\\n            lastname\\n            street\\n            city\\n            region {\\n                label\\n            }\\n            postcode\\n            country {\\n                label\\n            }\\n\\n            selected_shipping_method {\\n                carrier_title\\n                method_title\\n            }\\n        }\\n        ...ItemsReviewFragment\\n    }\\n    \",\"\\n\"])),k.a),p=Object(s.gql)(i||(i=u()([\"\\n    # This mutation will return a masked cart id. If a bearer token is provided for\\n    # a logged in user it will return the cart id for that user.\\n    mutation createCart {\\n        cartId: createEmptyCart\\n    }\\n\"]))),f=Object(s.gql)(r||(r=u()(['\\n    mutation placeOrder($cartId: String!) {\\n        placeOrder(input: { cart_id: $cartId }) @connection(key: \"placeOrder\") {\\n            order {\\n                order_number\\n            }\\n        }\\n    }\\n']))),b=Object(s.gql)(d||(d=u()([\"\\n    query getOrderDetails($cartId: String!) {\\n        cart(cart_id: $cartId) {\\n            id\\n            ...OrderConfirmationPageFragment\\n        }\\n    }\\n    \",\"\\n\"])),v),y=Object(s.gql)(l||(l=u()([\"\\n    query getCheckoutDetails($cartId: String!) {\\n        cart(cart_id: $cartId) {\\n            id\\n            ...CheckoutPageFragment\\n        }\\n    }\\n    \",\"\\n\"])),m.a),h=Object(s.gql)(o||(o=u()([\"\\n    query GetCustomerForCheckout {\\n        customer {\\n            id\\n            default_shipping\\n            firstname\\n        }\\n    }\\n\"])));n.a={mutations:{createCartMutation:p,placeOrderMutation:f},queries:{getCheckoutDetailsQuery:y,getCustomerQuery:h,getOrderDetailsQuery:b}}},842:function(e,n){var a={kind:\"Document\",definitions:[{kind:\"OperationDefinition\",operation:\"mutation\",name:{kind:\"Name\",value:\"setPaymentMethodOnCart\"},variableDefinitions:[{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"payment_method\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"payer_id\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"token\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"setPaymentMethodOnCart\"},arguments:[{kind:\"Argument\",name:{kind:\"Name\",value:\"input\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"cart_id\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"payment_method\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"code\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"payment_method\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"paypal_express\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"payer_id\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"payer_id\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"token\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"token\"}}}]}}]}}]}}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"cart\"},arguments:[],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"selected_payment_method\"},arguments:[],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"code\"},arguments:[],directives:[]},{kind:\"Field\",name:{kind:\"Name\",value:\"title\"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:505}};a.loc.source={body:\"mutation setPaymentMethodOnCart(\\n    $cart_id: String!\\n    $payment_method: String!\\n    $payer_id: String!\\n    $token: String!\\n) {\\n    setPaymentMethodOnCart(\\n        input: {\\n            cart_id: $cart_id\\n            payment_method: {\\n                code: $payment_method\\n                paypal_express: { payer_id: $payer_id, token: $token }\\n            }\\n        }\\n    ) {\\n        cart {\\n            selected_payment_method {\\n                code\\n                title\\n            }\\n        }\\n    }\\n}\\n\",name:\"GraphQL request\",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var a=0;a<e.definitions.length;a++){var t=e.definitions[a];if(t.name&&t.name.value==n)return t}}a.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,a){if(\"FragmentSpread\"===n.kind)a.add(n.name.value);else if(\"VariableDefinition\"===n.kind){var t=n.type;\"NamedType\"===t.kind&&a.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,a)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,a)})),n.definitions&&n.definitions.forEach((function(n){e(n,a)}))}(e,n),t[e.name.value]=n}})),e.exports=a,e.exports.setPaymentMethodOnCart=function(e,n){var a={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty(\"loc\")&&(a.loc=e.loc);var r=t[n]||new Set,d=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){d.has(e)||(d.add(e),(t[e]||new Set).forEach((function(e){l.add(e)})))}))}return d.forEach((function(n){var t=i(e,n);t&&a.definitions.push(t)})),a}(a,\"setPaymentMethodOnCart\")},843:function(e,n){var a={kind:\"Document\",definitions:[{kind:\"OperationDefinition\",operation:\"mutation\",name:{kind:\"Name\",value:\"setGuestEmailOnCart\"},variableDefinitions:[{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"email\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"String\"}}},directives:[]}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"setGuestEmailOnCart\"},arguments:[{kind:\"Argument\",name:{kind:\"Name\",value:\"input\"},value:{kind:\"ObjectValue\",fields:[{kind:\"ObjectField\",name:{kind:\"Name\",value:\"cart_id\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"cart_id\"}}},{kind:\"ObjectField\",name:{kind:\"Name\",value:\"email\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"email\"}}}]}}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"cart\"},arguments:[],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"email\"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:189}};a.loc.source={body:\"mutation setGuestEmailOnCart($cart_id: String!, $email: String!) {\\n    setGuestEmailOnCart(input: { cart_id: $cart_id, email: $email }) {\\n        cart {\\n            email\\n        }\\n    }\\n}\\n\",name:\"GraphQL request\",locationOffset:{line:1,column:1}};var t={};function i(e,n){for(var a=0;a<e.definitions.length;a++){var t=e.definitions[a];if(t.name&&t.name.value==n)return t}}a.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,a){if(\"FragmentSpread\"===n.kind)a.add(n.name.value);else if(\"VariableDefinition\"===n.kind){var t=n.type;\"NamedType\"===t.kind&&a.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,a)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,a)})),n.definitions&&n.definitions.forEach((function(n){e(n,a)}))}(e,n),t[e.name.value]=n}})),e.exports=a,e.exports.setGuestEmailOnCart=function(e,n){var a={kind:e.kind,definitions:[i(e,n)]};e.hasOwnProperty(\"loc\")&&(a.loc=e.loc);var r=t[n]||new Set,d=new Set,l=new Set;for(r.forEach((function(e){l.add(e)}));l.size>0;){var o=l;l=new Set,o.forEach((function(e){d.has(e)||(d.add(e),(t[e]||new Set).forEach((function(e){l.add(e)})))}))}return d.forEach((function(n){var t=i(e,n);t&&a.definitions.push(t)})),a}(a,\"setGuestEmailOnCart\")}}]);","extractedComments":[]}